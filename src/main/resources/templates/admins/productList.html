<!DOCTYPE html>
<html lang="en">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
>
<head th:include="parts/head.html :: head(title='Products')">

</head>
<body style="background-color: #eee">

<div id="wrapper">
    <header th:insert="admins/parts/header.html :: header_v(url_active='product')"></header>
    <div id="category-breadcrumb">
        <div class="container">
            <ul class="breadcrumb">
                <li><a href="index.html">Home</a></li>
                <li><a href="#">Electronics</a></li>
            </ul>
        </div>
    </div>
    <div class="container mt-5">
        <form method="get" action="/admins/product">
            <div class="form-row">
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <div class="input-group">
                        <span class="input-group-addon"><span class="input-icon input-icon-country"></span><span
                                class="input-text">SEARCH By:</span></span>
                        <div class="large-selectbox clearfix">
                            <select name="search_by" class="selectbox">
                                <option value="Id">Id</option>
                                <option value="Brand">Brand</option>
                                <option value="Name">Name</option>
                                <option value="Price">Price</option>
                                <option value="Sale">Sale</option>
                                <option value="Category">Category</option>
                                <option value="Size">Size</option>
                                <option>Find all</option>
                            </select>
                        </div><!-- End .large-selectbox-->
                    </div><!-- End .input-group -->
                </div>
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <div class="input-group input-group-lg">
                                    <span class="input-group-btn">
                                    <button class="btn btn-custom-2" type="submit"
                                            style="color: #7bae23 !important;background-color: #f2f2f2; border: 1px solid #dcdcdc;">Search</button>
                                    </span>
                        <input type="text" name="filter" class="form-control" placeholder="Search here"
                               th:value="${filter != null ? filter : ''}">
                    </div><!-- /input-group -->
                </div>
            </div>
            <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
        </form>

        <div class="col-md-12" style="text-align: center;">
            <input type="button" value="ADD NEW PRODUCT" class="btn btn-custom-2 md-margin" data-toggle="collapse"
                   href="#collapseExample" th:attrappend="class=${product != null ? ' collapsed' : ''}">
        </div>
        <div class="collapse " id="collapseExample" th:attrappend="class=${product != null ? ' in' : ''}">
            <div class="row" th:object="${product}">

                <th:block th:if="${hasErrors != null}">
                    <h4 style="color: #a94442; margin-left: 14px;">Please correct the problems below and resubmit.</h4>
                </th:block>

                <form method="post" enctype="multipart/form-data">
                    <div class="col-md-6 col-sm-6 col-xs-12">

                        <label class="control-label" style="color: #a94442;"
                               th:if="${nameError != null}" th:text="${nameError}"></label>
                        <div class="input-group"
                             th:attrappend="class=${nameError != null ? ' has-error my-has-error' : ''}">
                    <span class="input-group-addon"><span class="input-icon input-icon-user"></span><span
                            class="input-text">Name*</span></span>
                            <input type="text" class="form-control input-lg" placeholder="Product name"
                                   name="name"
                                   th:value="${product != null ? product.name : ''}"
                                   th:attrappend="style=${nameError != null ? 'border: 1px solid #a94442;' : ''}">
                        </div>

                        <label class="control-label" style="color: #a94442;"
                               th:if="${priceError != null}" th:text="${priceError}"></label>
                        <div class="input-group"
                             th:attrappend="class=${priceError != null ? ' has-error my-has-error' : ''}">
                    <span class="input-group-addon"><span class="input-icon input-icon-user"></span><span
                            class="input-text">Price*</span></span>
                            <input type="text" class="form-control input-lg" placeholder="Product price"
                                   name="price"
                                   th:value="${product != null ? product.price : ''}"
                                   th:attrappend="style=${priceError != null ? 'border: 1px solid #a94442;' : ''}">
                        </div>

                        <label class="control-label" style="color: #a94442;"
                               th:if="${saleError != null}" th:text="${saleError}"></label>
                        <div class="input-group"
                             th:attrappend="class=${saleError != null ? ' has-error my-has-error' : ''}">
                    <span class="input-group-addon"><span class="input-icon input-icon-user"></span><span
                            class="input-text">Sale*</span></span>
                            <input type="text" class="form-control input-lg" placeholder="Product sale"
                                   name="sale"
                                   th:value="${product != null ? product.sale : ''}"
                                   th:attrappend="style=${saleError != null ? 'border: 1px solid #a94442;' : ''}">
                        </div>

                        <label class="control-label" style="color: #a94442;"
                               th:if="${descriptionError != null}" th:text="${descriptionError}"></label>
                        <div class="input-group textarea-container"
                             th:attrappend="class=${descriptionError != null ? ' has-error my-has-error' : ''}">
                    <span class="input-group-addon"><span class="input-icon input-icon-message"></span><span
                            class="input-text">Description</span></span>
                            <textarea th:value="${product != null ? product.description : ''}"
                                      th:attrappend="style=${descriptionError != null ? 'border: 1px solid #a94442;' : ''}"
                                      name="description" id="contact-message" class="form-control" cols="30"
                                      rows="6"
                                      placeholder="Your test"></textarea>
                        </div>
                    </div>

                    <div class="col-md-6 col-sm-6 col-xs-12">

                        <div class="input-group">
                    <span class="input-group-addon"><span class="input-icon input-icon-country"></span><span
                            class="input-text">Brand*</span></span>
                            <div class="large-selectbox clearfix">
                                <select id="select-brand" name="brand" class="selectbox" title="brand"
                                        th:value="${product != null ? product.brand : ''}">
                                    <th:block th:each="brand : ${brands}">
                                        <option th:value="${brand.getName()}"
                                                th:text="${brand.getName()}">
                                        </option>
                                    </th:block>
                                </select>
                            </div><!-- End .large-selectbox-->
                        </div><!-- End .input-group -->

                        <div class="input-group">
                    <span class="input-group-addon"><span class="input-icon input-icon-country"></span><span
                            class="input-text">Category*</span></span>
                            <div class="large-selectbox clearfix">
                                <select id="select-category" name="category" class="selectbox" title="categories">
                                    <th:block th:each="categoryLevelOne : ${categoriesLevelOne}">
                                        <th:block th:each="categoryLevelTwo: ${categoriesLevelTwo}">
                                            <option th:if="${categoryLevelOne.id == categoryLevelTwo.ancestor.id}"
                                                    th:text="${categoryLevelOne.name + ' -> ' + categoryLevelTwo.name}"
                                                    th:value="${categoryLevelTwo.id}"></option>
                                        </th:block>
                                    </th:block>
                                </select>
                                </select>
                            </div><!-- End .large-selectbox-->
                        </div><!-- End .input-group -->

                        <div class="panel" style=" margin-bottom: 25px">
                            <div class="accordion-header" style="height: 47px; margin-bottom: 0px; padding: 15px 21px;">
                                <div class="accordion-title"><span>Color</span></div>
                                <!-- End .accordion-title -->
                                <a class="accordion-btn opened" data-toggle="collapse"
                                   data-target="#category-list-4"></a>
                            </div><!-- End .accordion-header -->

                            <style>
                                input[type="checkbox"] {
                                    display: none;
                                }

                                input[type="checkbox"]:checked + label span {
                                    transform: scale(1.25);
                                    border: #262626 solid 2px;
                                }
                            </style>
                            <div id="category-list-4" class="collapse in">
                                <div class="panel-body" style="border: 1px solid #e4e2e2; background-color: #fcfcfc;">
                                    <ul class="filter-color-list clearfix">
                                        <th:block th:each="color : ${colors}">
                                            <input type="checkbox" name="color" th:id="${color.getRgb()}"
                                                   th:value="${color.getRgb()}"/>
                                            <label th:class="label-color" th:for="${color.getRgb()}">
                                                <span th:attrappend="style=${'background-color: rgb(' + color.getRgb() + ');'}"></span>
                                            </label>
                                        </th:block>
                                    </ul>
                                </div><!-- End .panel-body -->
                            </div><!-- #collapse -->
                        </div><!-- End .panel -->

                        <div class="panel" style=" margin-bottom: 25px">
                            <div class="accordion-header" style="height: 47px; margin-bottom: 0px; padding: 15px 21px;">
                                <div class="accordion-title"><span>Size</span></div>
                                <!-- End .accordion-title -->
                                <a class="accordion-btn opened" data-toggle="collapse"
                                   data-target="#product-size"></a>
                            </div><!-- End .accordion-header -->
                            <style>
                                input[type="checkbox"] {
                                    display: none;
                                }

                                input[type="checkbox"]:checked + label span {
                                    transform: scale(1.25);
                                    border: #262626 solid 2px;
                                }
                            </style>
                            <div id="product-size" class="collapse in">
                                <div class="panel-body" style="border: 1px solid #e4e2e2; background-color: #fcfcfc;">
                                    <ul class="filter-color-list clearfix">
                                        <th:block th:each="size : ${sizes}">
                                            <input type="checkbox" name="sizes" th:id="${size.getSize()}"
                                                   th:value="${size.getSize()}"/>
                                            <label th:class="label-size" th:for="${size.getSize()}">
                                                <span th:text="${size.getSize()}"></span>
                                            </label>
                                        </th:block>
                                    </ul>
                                </div><!-- End .panel-body -->
                            </div><!-- #collapse -->
                        </div><!-- End .panel -->

                        <div class="form-group" style="text-align: center">
                            <input type="submit" value="ADD PRODUCT" class="btn btn-custom-2 md-margin">
                        </div>
                    </div>
                    <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                </form>
            </div>
        </div>

        <div class="category-toolbar clearfix">
            <th:block th:include="admins/parts/pager.html :: pager(${url}, ${page},${listpages})"></th:block>
        </div>
        <div class="card-columns">
            <th:block th:if="${page.getTotalElements() < 1}">
                <li colspan="2"> No product Available</li>
            </th:block>
            <table class="table cart-table">
                <thead>
                <tr>
                    <th class="table-title">Id</th>
                    <th class="table-title">Product Name</th>
                    <th class="table-title">Description</th>
                    <th class="table-title">Price</th>
                    <th class="table-title">Sale</th>
                    <th class="table-title">Brand</th>
                    <th class="table-title">Size</th>
                    <th class="table-title">Category</th>
                </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <th:block th:each="item : ${page.content}">
                <div class="card my-3 ">

                    <div class="card-body">
                        <h5 class="card-title" th:text="'Id: ' + ${item.id}">Card title</h5>
                        <h5 class="card-title" th:text="'name: ' + ${item.name}">Card title</h5>
                        <p class="card-text" th:text="'description: ' + ${item.description}"></p>
                        <p class="card-text" th:text="'price: ' + ${item.price}"></p>
                        <p class="card-text" th:text="'sale: ' + ${item.sale}"></p>
                        <p class="card-text" th:text="'brand: ' + ${item.brand.getName()}"></p>
                        <th:block th:each="color : ${item.color.iterator()}">
                            <label th:class="label-color" th:for="${color}">
                                <span th:attrappend="style=${'background-color: rgb(' + color.rgb + ');'}"></span>
                            </label>
                        </th:block>
                        <th:block th:each="size : ${item.sizes.iterator()}">
                            <label th:class="label-size" th:for="${size}">
                                <span th:text="${size.getSize()}"></span>
                            </label>
                        </th:block>
                        <p class="card-text" th:text="'newProduct: ' + ${item.newProduct}"></p>

                    </div>

                    <div class="card-footer ">
                        <small class="text-muted"
                               th:if="${item.category != null}"
                               th:text="${'Category: ' + item.category.name + ' -> ' + item.category.ancestor.name + ';'}"></small>

                        <small class="text-muted"
                               th:if="${item.filename != null}"
                               th:text="${'Image 1: Yes;'}"></small>
                        <small class="text-muted"
                               th:unless="${item.filename != null}"
                               th:text="${'Image 1: No;'}"></small>

                        <small class="text-muted"
                               th:if="${item.hoverFilename != null}"
                               th:text="${'Image 2: Yes;'}"></small>
                        <small class="text-muted"
                               th:unless="${item.hoverFilename != null}"
                               th:text="${'Image 2: No;'}"></small>

                        <div class="text-right">
                            <a th:href="@{/admins/product/images/{path}(path=${item.id})}">images</a>
                            <a th:href="@{/product/delete(id=${item.id})}">delete</a>
                            <a type="button" data-toggle="modal" th:data-target="'#' + ${item.id}">edit</a>
                        </div>

                    </div>

                    <div class="modal fade" th:id="${item.id}">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <form enctype="multipart/form-data" th:action="@{'/product/edit/' + ${item.id}}"
                                      method="post">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                        <h4 class="modal-title" th:text="'Edit Product № ' + ${item.id}"></h4>
                                    </div>
                                    <div class="modal-body">
                                        <div class="form-group">
                                            <input type="text" class="form-control"
                                                   th:value="${item != null ? item.name : ''}"
                                                   name="name"
                                                   placeholder="Input name"/></div>
                                        <div class="form-group">
                                            <input type="text" class="form-control"
                                                   th:value="${item != null ? item.description : ''}"
                                                   name="description"
                                                   placeholder="Input description"/></div>
                                        <div class="form-group">
                                            <input type="number" class="form-control"
                                                   th:value="${item != null ? item.price : ''}"
                                                   name="price"
                                                   placeholder="Input text"></div>
                                        <div class="form-group">
                                            <select class="form-control" id="edit_brand" name="brand" title="brand">
                                                <th:block th:each="brand : ${brands}">
                                                    <th:block
                                                            th:if="${#strings.contains(brand.getName(),item.brand.getName())}">
                                                        <option th:text="${brand.getName()}" selected></option>
                                                    </th:block>
                                                    <th:block
                                                            th:unless="${#strings.contains(brand.getName(),item.brand.getName())}">
                                                        <option th:text="${brand.getName()}"></option>
                                                    </th:block>
                                                </th:block>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <th:block th:each="color : ${colors}">
                                                <input type="checkbox" name="color" th:id="${color.getRgb()}"
                                                       th:value="${color.getRgb()}"/>
                                                <label th:class="label-color" th:for="${color.getRgb()}">
                                                    <span th:attrappend="style=${'background-color: rgb(' + color.getRgb() + ');'}"></span>
                                                </label>
                                            </th:block>
                                        </div>
                                        <div class="form-group">
                                            <select class="form-control" id="edit_newProduct" name="newProduct"
                                                    title="newProduct">
                                                <option>true</option>
                                                <option>false</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <input type="number" class="form-control"
                                                   th:value="${item != null ? item.sale : ''}"
                                                   name="sale"
                                                   placeholder="Input sale"></div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
                                            </button>
                                            <button type="submit" class="btn btn-primary">Save changes</button>
                                        </div>
                                        <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                                    </div>
                                </form>
                            </div><!-- /.модальное окно-Содержание -->
                        </div><!-- /.модальное окно-диалог -->
                    </div><!-- /.модальное окно -->
                </div>
            </th:block>

        </div>

        <div th:include="admins/parts/pager.html :: pager(${url}, ${page},${listpages})"></div>
    </div>
    <th:block th:insert="parts/footer.html :: afterFooter"></th:block><!-- End #footer --></div>
</body>
</html>